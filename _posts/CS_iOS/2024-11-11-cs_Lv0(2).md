---
title:  "[iOS] CS 정리 LV0(2)"
excerpt: "CS in iOS"

categories:
  - CS
tags:
  - CS, iOS
last_modified_at: 2024-11-11T13:40:02-05:00
---


### 6. 프로세스와 스레드의 차이점, 그리고 iOS에서의 프로세스와 스레드 관리 방법에 대해 설명해주세요.

**프로세스**란 실행 중인 프로그램의 인스턴스 -> 프로그램이 메모리에 적재되어 실행되고 있는 상태.<br>
**스레드**란 프로세스 내에서 실행되는 가장 작은 실행 단위.
- 프로세스는 스택, 힙, 데이터, 코드(텍스트)로 이루어져 있다.
- 프로세스 안에 여러 스레드가 있을 수 있으면 모든 스레드는 프로세스의 힙, 데이터, 코드를 공유하지만 스택은 개별적으로 가진다.
- 같은 프로세스 내에서 자원을 공유하므로 스레드는 통신이 쉬운 반면, 프로세스는 오버헤드가 크다.
- 스레드는 프로세스의 자원과 메모리 공간을 공유하기 때문에 프로세스 안에서 한 스레드에 문제가 생기면 프로세스 전체에 영향을 줄 수 있다.
- 또한 자원 경쟁으로 인한 복잡성이 높다.
<br><br>
**iOS에서의 프로세스와 스레드**<br>
1. 프로세스
  - iOS는 각 앱을 독립적은 프로세스로 실행한다.
  - 백그라운드로 전환되거나 메모리가 부족할 떄는 iOS가 앱을 일시 정지하거나 종료해서 자원을 관리한다.

2. 스레드
  - 메인 스레드: 사용자와의 직접 상호작용을 하고 UI업데이트를 담당한다.
    - 빠르게 반응하기 위해서 가벼운 작업만 수행해야 한다.
  - 백그라운드 스레드: 메인 스레드에서 처리하기 무거운 작업이나 비동기 작업을 수행한다.
    - 예: 파일 다운로드, 네트워크 요청, 대규모 데이터 치리 등

**멀티 스레딩**을 사용하면 작업을 병렬적으로 수행하여 빠르게 완료할 수 있다. 
또한 무거운 작업을 백그라운드에서 처리하여 UI가 느려지는 것을 방지할 수 있다.
<br><br>

**GCD(Grand Central Dispatch)** 란 <br>
비동기 작업을 쉽게 관리하는 API로 쉽게 스레드를 생성하고 관리한다. 작업 큐를 관리하여 비동기적으로 작업을 처리한다.
- 작업을 메인 스레드에서 분리하여 백그라운드에서 비동기로 처리한다.
- Dispatch Queue를 이용해서 멀티 스레딩을 쉽게 관리하도록 한다.
  - Dispatch Queue: 앱이 실행되면 두 가지 Queue가 생성.
    - Main Queue: 메인 스레드에서 사용됨 한번에 한 개의 작업을 순차적으로 처리함.
    - Global Queue: 동시에 여러 작업을 수행함.
<br><br>

### 7. 메모리 관리 기법 중 iOS에서 사용되는 방식과 그 특징에 대해 설명해주세요.

**ARC(Automatic Reference Counting)**<br>
1. 참조(Reference) 타입과 힙
힙은 객체들이 동적으로 생성되는 메모리 공간으로 Swift는 인스턴스 생성 시 자동으로 힙에 할당하여 관리한다.
이렇게 할당된 인스턴스는 다른 변수들이 그 인스턴스를 참조하는 형태로 관리된다.

```Swift
class Car {
    var model: String?
    var year: Int?
    
    init(model: String?, year: Int?) {
        self.model = model
        self.year = year
    }
}

let myCar = Car(model: "Tesla S", year: 2023)
```
여기서 myCar는 스택에 할당되고, 힙에 할당된 Car 인스턴스를 참조한다. 
**let clone = myCar**처럼 다른 변수가 동일한 인스턴스를 참조할 경우 새로운 메모리가 아닌 동일한 힙 메모리 위치를 참조한다.

2. ARC의 정의와 동작 원리
ARC는 힙에 할당된 클래스 인스턴스를 더 이상 필요하지 않을 때 메모리에서 해제하는 자동 메모리 관리 기법이다. 
SWift에서는 ARC를 통해 참조 타입의 메모리를 관리하고, 프로그래머가 직접 메모리를 해제할 필요 없이 메모리 누수를 방지할 수 있다.

3. GC(Garbage Collection) vs RC(Reference Counting)

| 구분                 | GC (Garbage Collection)          | RC (Reference Counting)         |
|---------------------|----------------------------------|---------------------------------|
| 참조 계산 시점        | 런타임에 주기적으로 참조 추적       | 컴파일 시점에 결정됨             |
| 장점                 | 사용되지 않는 인스턴스를 주기적으로 해제 | 참조 해제 시점을 예측 가능         |
| 단점                 | 런타임에 추가 리소스 사용으로 성능 저하 | 순환 참조 시 메모리 해제 불가       |

<br>

4. ARC 메모리 관리 방법
Reference Counting을 기반으로 메모리를 관리한다. 참조 횟수가 증가할 때는 인스턴스를 할당하고 참조횟수가 0이 되면 메모리를 해제한다.
- Count Up: 새로운 인스턴스 생성, 기존 인스턴스 복사.
- Count Down: 변수 해제, 변수에 nil 할당, 기존 변수에 다른 인스턴스 할당, 클래스 인스턴스 해제.

5. 순환 참조 문제
두 인스턴스가 서로를 참조해 참조 횟수가 0이 되지 않는 문제가 발행해 메모리가 영구적으로 해제되지 않는다. 
이를 해결하기 위해 Swift는 약한 참조와 비소유 참조를 사용한다.

<br><br>

### 8. iOS의 샌드박스(Sandbox) 개념과 역할, 그리고 앱 간 데이터 공유 방법에 대해 설명해주세요.

**샌드박스**는 각 앱을 보호된 공간에서 실행하도록 하는 보안 모델로 다른 앱의 데이터나 시스템 리소스에 접근하지 못하도록 격리한다.
<br>

**커널 수준에서 샌드박스가 적용되는 이유**
- 운영체제의 핵심인 커널이 시스템의 자원에 대한 접근을 제어하고 관리한다.
- 그래서 각 앱이 다른 앱이나 시스템 자원에 접근하는 것을 강제로 제한할 수 있다.
- 각 앱이 독립적인 샌드박스 환경에서 실행되어 앱 간의 충돌이나 악성 앱의 확산을 효율적으로 차단한다.
- 카메라, 마이크, 위치 정보와 같은 하드웨어 리소스에 대한 접근을 커널에서 관리한다.
<br><br>

**샌드 박스의 주요 역할** 
- 각 앱은 자신의 샌드박스 내에서 실행되어 다른 앱과 데이터를 공유하지 않는다. 격리를 통해 다른 앱에 문제가 생겨도 앱이나 시스템에 영향을 주지 않는다.
- 앱은 카메라, 마이크, 파일 시스템과 같은 리소스에 접근하려면 명시적인 권한을 받아야 한다.
<br><br>

**샌드박스의 구성 요소**
샌드박스는 앱마다 특정 디렉터리 구조로 구성되며 각 앱의 데이터는 독립된 '홈 디렉토리' 내에 저장된다.
홈 디렉토리:
- Bundle Container: 엡의 실행 파일, 리소스 파일 등을 포함한다. 읽기 전용으로 수정이 필요한 파일은 Data Container로 이동한다.
- Data Container: 앱에서 사용되는 데이터 파일을 보관한다. 
  - Documents: 사용자 데이터나 앱에서 생성한 문서 저장.
  - Library: 앱 설정 파일, 캐시 파일 등을 저장.
  - Temp: 임시 데이터가 저장되는 공간으로, 앱이 실행중일 때만 필요하다.
- iCloud Container: 앱이 iCloud를 사용하여 데이터를 저장하고 공유할 수 있도록 한다.
<br><br>

**앱 간 데이터 공유 방법**
1. App Groups: 동일한 개발자가 만든 앱끼리 데이터를 공유할 수 있다.
2. URL Scheme: 하나의 앱에서 다른 앱을 호출학거나 데이터를 전달한다.
3. UIPasteBoard: 텍스트나 이미지를 복사하고 다른 앱에 붙여넣을 수 있다.
4. Shared Keychain: 여러 앱이 같은 키체인에 접근해서 암호화된 데이터를 공유할 수 있다.
5. iCloud: 여러 앱이 데이터를 클라우드에 저장하고 다른 기기나 앱에서 공유할 수 있다.

<br><br>

### 9. iOS에서의 메모리 구조와 관리 방식에 대해 자세히 설명해주세요.
메모리는 크게 4가지 영역(코드, 데이터, 힙, 스택)으로 나뉘어져 있다.
1. 코드 
  - 앱이 실행할 코드가 저장된다. 앱이 실행되면 해당 코드가 CPU에 의해 실행된다.
  - 읽기 전용 메모리로, 프로그램 실행 중 코드가 변경되지 않는다.
  - 컴파일 타입에 결정된다.

2. 데이터
  - 전역 변수와 정적(static)변수가 저장된다.
  - 프로그램의 시작과 동시에 메모리가 할당된다.
  - 프로그램 이 종료되기 전까지 메모리가 해제되지 않는다.

3. 힙
- 동적으로 메모리 할당이 이루어져서 런타임에 데이터 크기가 결정된다.( malloc 또는 calloc같은 함수로 이루어진다.)
- ARC가 메모리를 관리한다.
- 메모리 크기에 제한이 없다.

4. 스택
- 함수 호출 시 지역변수, 매개변수, 리턴 값 등이 저장되는 임시 메모리 영역이다.
- LIFO 구조로 관리된다.
- 함수 호출 시 변수가 저장되고 함수가 종료되면 메모리는 반환된다.
- 컴파일 타임에 결정되고 메모리 크기에 제한이 있어 너무 많은 데이터를 할당하면 스택 오버플로우가 발생할 수 있다.

**힙과 스택은 서로 다른 방식으로 메모리를 관리한다.**
- 메모리 크가나 데이터가 동적으로 결정될 경우 힙 영역에 할당된다.
- 함수 호출 시 고정된 크기의 데이터는 스택 영역에 할당된다.

<br>

#### 참고
- 컴퓨터 구조와 운영체제 핵심 노트
- https://github.com/JeaSungLEE/iOSInterviewquestions?tab=readme-ov-file
- https://babbab2.tistory.com/26
- https://jinnify.tistory.com/26
- https://raidho.tistory.com/277
